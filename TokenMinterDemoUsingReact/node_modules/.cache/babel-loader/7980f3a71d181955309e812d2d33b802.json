{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ethUtil = require(\"ethereumjs-util\");\n\nvar _ = require(\"lodash\");\n\nvar set_1 = require(\"../abstract_data_types/types/set\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar tuple_1 = require(\"./tuple\");\n\nvar MethodDataType =\n/** @class */\nfunction (_super) {\n  __extends(MethodDataType, _super);\n\n  function MethodDataType(abi, dataTypeFactory) {\n    var _this = this;\n\n    var methodDataItem = {\n      type: 'method',\n      name: abi.name,\n      components: abi.inputs\n    };\n    _this = _super.call(this, methodDataItem, dataTypeFactory) || this;\n    _this._methodSignature = _this._computeSignature();\n    _this._methodSelector = _this._computeSelector();\n    var returnDataItem = {\n      type: 'tuple',\n      name: abi.name,\n      components: abi.outputs\n    };\n    _this._returnDataType = new tuple_1.TupleDataType(returnDataItem, _this.getFactory());\n    return _this;\n  }\n\n  MethodDataType.prototype.encode = function (value, rules) {\n    var calldata = _super.prototype.encode.call(this, value, rules, this._methodSelector);\n\n    return calldata;\n  };\n\n  MethodDataType.prototype.decode = function (calldata, rules) {\n    var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n\n    return value;\n  };\n\n  MethodDataType.prototype.strictDecode = function (calldata, rules) {\n    var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n\n    var valueAsArray = _.isObject(value) ? _.values(value) : [value];\n\n    switch (valueAsArray.length) {\n      case 0:\n        return undefined;\n\n      case 1:\n        return valueAsArray[0];\n\n      default:\n        return valueAsArray;\n    }\n  };\n\n  MethodDataType.prototype.encodeReturnValues = function (value, rules) {\n    var returnData = this._returnDataType.encode(value, rules);\n\n    return returnData;\n  };\n\n  MethodDataType.prototype.decodeReturnValues = function (returndata, rules) {\n    var returnValues = this._returnDataType.decode(returndata, rules);\n\n    return returnValues;\n  };\n\n  MethodDataType.prototype.strictDecodeReturnValue = function (returndata, rules) {\n    var returnValues = this._returnDataType.decode(returndata, rules);\n\n    var returnValuesAsArray = _.isObject(returnValues) ? _.values(returnValues) : [returnValues];\n\n    switch (returnValuesAsArray.length) {\n      case 0:\n        return undefined;\n\n      case 1:\n        return returnValuesAsArray[0];\n\n      default:\n        return returnValuesAsArray;\n    }\n  };\n\n  MethodDataType.prototype.getSignatureType = function () {\n    return this._methodSignature;\n  };\n\n  MethodDataType.prototype.getSelector = function () {\n    return this._methodSelector;\n  };\n\n  MethodDataType.prototype.getReturnValueDataItem = function () {\n    var returnValueDataItem = this._returnDataType.getDataItem();\n\n    return returnValueDataItem;\n  };\n\n  MethodDataType.prototype._computeSignature = function () {\n    var memberSignature = this._computeSignatureOfMembers();\n\n    var methodSignature = \"\" + this.getDataItem().name + memberSignature;\n    return methodSignature;\n  };\n\n  MethodDataType.prototype._computeSelector = function () {\n    var signature = this._computeSignature();\n\n    var selector = ethUtil.bufferToHex(ethUtil.toBuffer(ethUtil.sha3(signature).slice(constants_1.constants.HEX_SELECTOR_BYTE_OFFSET_IN_CALLDATA, constants_1.constants.HEX_SELECTOR_LENGTH_IN_BYTES)));\n    return selector;\n  };\n\n  return MethodDataType;\n}(set_1.AbstractSetDataType);\n\nexports.MethodDataType = MethodDataType;","map":{"version":3,"mappings":"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","names":["__extends","abi","dataTypeFactory","methodDataItem","type","name","components","inputs","_this","_methodSignature","_computeSignature","_methodSelector","_computeSelector","returnDataItem","outputs","_returnDataType","tuple_1","getFactory","MethodDataType","value","rules","calldata","_super","encode","call","decode","valueAsArray","_","isObject","values","length","undefined","returnData","returndata","returnValues","returnValuesAsArray","returnValueDataItem","getDataItem","memberSignature","_computeSignatureOfMembers","methodSignature","signature","selector","ethUtil","bufferToHex","toBuffer","sha3","slice","constants_1","HEX_SELECTOR_BYTE_OFFSET_IN_CALLDATA","HEX_SELECTOR_LENGTH_IN_BYTES","set_1","exports"],"sources":["../../../../src/abi_encoder/evm_data_types/method.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}