{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ = require(\"lodash\");\n\nvar set_1 = require(\"../abstract_data_types/types/set\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar ArrayDataType =\n/** @class */\nfunction (_super) {\n  __extends(ArrayDataType, _super);\n\n  function ArrayDataType(dataItem, dataTypeFactory) {\n    var _this = this; // Construct parent\n\n\n    var isArray = true;\n\n    var _a = __read(ArrayDataType._decodeElementTypeAndLengthFromType(dataItem.type), 2),\n        arrayElementType = _a[0],\n        arrayLength = _a[1];\n\n    _this = _super.call(this, dataItem, dataTypeFactory, isArray, arrayLength, arrayElementType) || this; // Set array properties\n\n    _this._elementType = arrayElementType;\n    return _this;\n  }\n\n  ArrayDataType.matchType = function (type) {\n    return ArrayDataType._MATCHER.test(type);\n  };\n\n  ArrayDataType._decodeElementTypeAndLengthFromType = function (type) {\n    var matches = ArrayDataType._MATCHER.exec(type);\n\n    if (matches === null || matches.length !== 3) {\n      throw new Error(\"Could not parse array: \" + type);\n    } else if (matches[1] === undefined) {\n      throw new Error(\"Could not parse array type: \" + type);\n    } else if (matches[2] === undefined) {\n      throw new Error(\"Could not parse array length: \" + type);\n    }\n\n    var arrayElementType = matches[1];\n    var arrayLength = _.isEmpty(matches[2]) ? undefined : parseInt(matches[2], constants_1.constants.DEC_BASE);\n    return [arrayElementType, arrayLength];\n  };\n\n  ArrayDataType.prototype.getSignatureType = function () {\n    return this._computeSignature(false);\n  };\n\n  ArrayDataType.prototype.getSignature = function (isDetailed) {\n    if (_.isEmpty(this.getDataItem().name) || !isDetailed) {\n      return this.getSignatureType();\n    }\n\n    var name = this.getDataItem().name;\n    var lastIndexOfScopeDelimiter = name.lastIndexOf('.');\n    var isScopedName = lastIndexOfScopeDelimiter !== undefined && lastIndexOfScopeDelimiter > 0;\n    var shortName = isScopedName ? name.substr(lastIndexOfScopeDelimiter + 1) : name;\n\n    var detailedSignature = shortName + \" \" + this._computeSignature(isDetailed);\n\n    return detailedSignature;\n  };\n\n  ArrayDataType.prototype._computeSignature = function (isDetailed) {\n    // Compute signature for a single array element\n    var elementDataItem = {\n      type: this._elementType,\n      name: ''\n    };\n    var elementComponents = this.getDataItem().components;\n\n    if (elementComponents !== undefined) {\n      elementDataItem.components = elementComponents;\n    }\n\n    var elementDataType = this.getFactory().create(elementDataItem);\n    var elementSignature = elementDataType.getSignature(isDetailed); // Construct signature for array of type `element`\n\n    if (this._arrayLength === undefined) {\n      return elementSignature + \"[]\";\n    } else {\n      return elementSignature + \"[\" + this._arrayLength + \"]\";\n    }\n  };\n\n  ArrayDataType._MATCHER = RegExp('^(.+)\\\\[([0-9]*)\\\\]$');\n  return ArrayDataType;\n}(set_1.AbstractSetDataType);\n\nexports.ArrayDataType = ArrayDataType;","map":{"version":3,"mappings":"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","names":["__extends","dataItem","dataTypeFactory","isArray","arrayElementType","arrayLength","_this","_elementType","ArrayDataType","type","_MATCHER","test","matches","exec","length","Error","undefined","_","isEmpty","parseInt","constants_1","DEC_BASE","_computeSignature","isDetailed","getDataItem","name","getSignatureType","lastIndexOfScopeDelimiter","lastIndexOf","isScopedName","shortName","substr","detailedSignature","elementDataItem","elementComponents","components","elementDataType","getFactory","create","elementSignature","getSignature","_arrayLength","RegExp","set_1","exports"],"sources":["../../../../src/abi_encoder/evm_data_types/array.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}