{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ethUtil = require(\"ethereumjs-util\");\n\nvar constants_1 = require(\"../../utils/constants\");\n\nvar calldata_block_1 = require(\"../calldata_block\");\n\nvar PointerCalldataBlock =\n/** @class */\nfunction (_super) {\n  __extends(PointerCalldataBlock, _super);\n\n  function PointerCalldataBlock(name, signature, parentName, dependency, parent) {\n    var _this = this;\n\n    var headerSizeInBytes = PointerCalldataBlock._EMPTY_HEADER_SIZE;\n    var bodySizeInBytes = PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES;\n    _this = _super.call(this, name, signature, parentName, headerSizeInBytes, bodySizeInBytes) || this;\n    _this._parent = parent;\n    _this._dependency = dependency;\n    _this._aliasFor = undefined;\n    return _this;\n  }\n\n  PointerCalldataBlock.prototype.toBuffer = function () {\n    var destinationOffset = this._aliasFor !== undefined ? this._aliasFor.getOffsetInBytes() : this._dependency.getOffsetInBytes();\n\n    var parentOffset = this._parent.getOffsetInBytes();\n\n    var parentHeaderSize = this._parent.getHeaderSizeInBytes();\n\n    var pointer = destinationOffset - (parentOffset + parentHeaderSize);\n    var pointerHex = \"0x\" + pointer.toString(constants_1.constants.HEX_BASE);\n    var pointerBuf = ethUtil.toBuffer(pointerHex);\n    var pointerBufPadded = ethUtil.setLengthLeft(pointerBuf, constants_1.constants.EVM_WORD_WIDTH_IN_BYTES);\n    return pointerBufPadded;\n  };\n\n  PointerCalldataBlock.prototype.getDependency = function () {\n    return this._dependency;\n  };\n\n  PointerCalldataBlock.prototype.setAlias = function (block) {\n    this._aliasFor = block;\n\n    this._setName(this.getName() + \" (alias for \" + block.getName() + \")\");\n  };\n\n  PointerCalldataBlock.prototype.getAlias = function () {\n    return this._aliasFor;\n  };\n\n  PointerCalldataBlock.prototype.getRawData = function () {\n    var dependencyRawData = this._dependency.getRawData();\n\n    var rawDataComponents = [];\n    rawDataComponents.push(PointerCalldataBlock.RAW_DATA_START);\n    rawDataComponents.push(dependencyRawData);\n    rawDataComponents.push(PointerCalldataBlock.RAW_DATA_END);\n    var rawData = Buffer.concat(rawDataComponents);\n    return rawData;\n  };\n\n  PointerCalldataBlock.RAW_DATA_START = new Buffer('<');\n  PointerCalldataBlock.RAW_DATA_END = new Buffer('>');\n  PointerCalldataBlock._DEPENDENT_PAYLOAD_SIZE_IN_BYTES = 32;\n  PointerCalldataBlock._EMPTY_HEADER_SIZE = 0;\n  return PointerCalldataBlock;\n}(calldata_block_1.CalldataBlock);\n\nexports.PointerCalldataBlock = PointerCalldataBlock;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAGA;;AAEA;;AAEA;AAAA;AAAA;EAA0CA;;EAStC,8BAAYC,IAAZ,EAA0BC,SAA1B,EAA6CC,UAA7C,EAAiEC,UAAjE,EAA4FC,MAA5F,EAAiH;IAAjH;;IACI,IAAMC,iBAAiB,GAAGC,oBAAoB,CAACC,kBAA/C;IACA,IAAMC,eAAe,GAAGF,oBAAoB,CAACG,gCAA7C;IACAC,0BAAMV,IAAN,EAAYC,SAAZ,EAAuBC,UAAvB,EAAmCG,iBAAnC,EAAsDG,eAAtD,KAAsE,IAAtE;IACAE,KAAI,CAACC,OAAL,GAAeP,MAAf;IACAM,KAAI,CAACE,WAAL,GAAmBT,UAAnB;IACAO,KAAI,CAACG,SAAL,GAAiBC,SAAjB;;EACH;;EAEMR,0CAAP;IACI,IAAMS,iBAAiB,GACnB,KAAKF,SAAL,KAAmBC,SAAnB,GAA+B,KAAKD,SAAL,CAAeG,gBAAf,EAA/B,GAAmE,KAAKJ,WAAL,CAAiBI,gBAAjB,EADvE;;IAEA,IAAMC,YAAY,GAAG,KAAKN,OAAL,CAAaK,gBAAb,EAArB;;IACA,IAAME,gBAAgB,GAAG,KAAKP,OAAL,CAAaQ,oBAAb,EAAzB;;IACA,IAAMC,OAAO,GAAWL,iBAAiB,IAAIE,YAAY,GAAGC,gBAAnB,CAAzC;IACA,IAAMG,UAAU,GAAG,OAAKD,OAAO,CAACE,QAAR,CAAiBC,sBAAUC,QAA3B,CAAxB;IACA,IAAMC,UAAU,GAAGC,OAAO,CAACC,QAAR,CAAiBN,UAAjB,CAAnB;IACA,IAAMO,gBAAgB,GAAGF,OAAO,CAACG,aAAR,CAAsBJ,UAAtB,EAAkCF,sBAAUO,uBAA5C,CAAzB;IACA,OAAOF,gBAAP;EACH,CAVM;;EAYAtB,+CAAP;IACI,OAAO,KAAKM,WAAZ;EACH,CAFM;;EAIAN,0CAAP,UAAgByB,KAAhB,EAAoC;IAChC,KAAKlB,SAAL,GAAiBkB,KAAjB;;IACA,KAAKC,QAAL,CAAiB,KAAKC,OAAL,KAAc,cAAd,GAA6BF,KAAK,CAACE,OAAN,EAA7B,GAA4C,GAA7D;EACH,CAHM;;EAKA3B,0CAAP;IACI,OAAO,KAAKO,SAAZ;EACH,CAFM;;EAIAP,4CAAP;IACI,IAAM4B,iBAAiB,GAAG,KAAKtB,WAAL,CAAiBuB,UAAjB,EAA1B;;IACA,IAAMC,iBAAiB,GAAa,EAApC;IACAA,iBAAiB,CAACC,IAAlB,CAAuB/B,oBAAoB,CAACgC,cAA5C;IACAF,iBAAiB,CAACC,IAAlB,CAAuBH,iBAAvB;IACAE,iBAAiB,CAACC,IAAlB,CAAuB/B,oBAAoB,CAACiC,YAA5C;IACA,IAAMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAcN,iBAAd,CAAhB;IACA,OAAOI,OAAP;EACH,CARM;;EA1CgBlC,sCAAiB,IAAImC,MAAJ,CAAW,GAAX,CAAjB;EACAnC,oCAAe,IAAImC,MAAJ,CAAW,GAAX,CAAf;EACCnC,wDAAmC,EAAnC;EACAA,0CAAqB,CAArB;EAgD5B;AAAC,CApDD,CAA0CqC,8BAA1C;;AAAaC","names":["__extends","name","signature","parentName","dependency","parent","headerSizeInBytes","PointerCalldataBlock","_EMPTY_HEADER_SIZE","bodySizeInBytes","_DEPENDENT_PAYLOAD_SIZE_IN_BYTES","_this","_parent","_dependency","_aliasFor","undefined","destinationOffset","getOffsetInBytes","parentOffset","parentHeaderSize","getHeaderSizeInBytes","pointer","pointerHex","toString","constants_1","HEX_BASE","pointerBuf","ethUtil","toBuffer","pointerBufPadded","setLengthLeft","EVM_WORD_WIDTH_IN_BYTES","block","_setName","getName","dependencyRawData","getRawData","rawDataComponents","push","RAW_DATA_START","RAW_DATA_END","rawData","Buffer","concat","calldata_block_1","exports"],"sources":["../../../../../src/abi_encoder/calldata/blocks/pointer.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}