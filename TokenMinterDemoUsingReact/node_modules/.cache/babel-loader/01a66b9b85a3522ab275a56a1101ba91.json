{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ = require(\"lodash\");\n\nvar calldata_1 = require(\"../calldata/calldata\");\n\nvar raw_calldata_1 = require(\"../calldata/raw_calldata\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar DataType =\n/** @class */\nfunction () {\n  function DataType(dataItem, factory) {\n    this._dataItem = dataItem;\n    this._factory = factory;\n  }\n\n  DataType.prototype.getDataItem = function () {\n    return this._dataItem;\n  };\n\n  DataType.prototype.getFactory = function () {\n    return this._factory;\n  };\n\n  DataType.prototype.encode = function (value, rules, selector) {\n    var rules_ = rules === undefined ? constants_1.constants.DEFAULT_ENCODING_RULES : rules;\n    var calldata = new calldata_1.Calldata(rules_);\n\n    if (selector !== undefined) {\n      calldata.setSelector(selector);\n    }\n\n    var block = this.generateCalldataBlock(value);\n    calldata.setRoot(block);\n    var encodedCalldata = calldata.toString();\n    return encodedCalldata;\n  };\n\n  DataType.prototype.decode = function (calldata, rules, selector) {\n    if (selector !== undefined && !_.startsWith(calldata, selector)) {\n      throw new Error(\"Tried to decode calldata, but it was missing the function selector. Expected prefix '\" + selector + \"'. Got '\" + calldata + \"'.\");\n    }\n\n    var hasSelector = selector !== undefined;\n    var rawCalldata = new raw_calldata_1.RawCalldata(calldata, hasSelector);\n    var rules_ = rules === undefined ? constants_1.constants.DEFAULT_DECODING_RULES : rules;\n    var value = rawCalldata.getSizeInBytes() > 0 ? this.generateValue(rawCalldata, rules_) : this.getDefaultValue(rules_);\n    return value;\n  };\n\n  DataType.prototype.decodeAsArray = function (returndata, rules) {\n    var value = this.decode(returndata, rules);\n    var valuesAsArray = _.isObject(value) ? _.values(value) : [value];\n    return valuesAsArray;\n  };\n\n  DataType.prototype.getSignature = function (isDetailed) {\n    if (_.isEmpty(this._dataItem.name) || !isDetailed) {\n      return this.getSignatureType();\n    }\n\n    var name = this.getDataItem().name;\n    var lastIndexOfScopeDelimiter = name.lastIndexOf('.');\n    var isScopedName = lastIndexOfScopeDelimiter !== undefined && lastIndexOfScopeDelimiter > 0;\n    var shortName = isScopedName ? name.substr(lastIndexOfScopeDelimiter + 1) : name;\n    var detailedSignature = shortName + \" \" + this.getSignatureType();\n    return detailedSignature;\n  };\n\n  return DataType;\n}();\n\nexports.DataType = DataType;","map":{"version":3,"mappings":"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","names":["dataItem","factory","_dataItem","_factory","DataType","value","rules","selector","rules_","undefined","constants_1","DEFAULT_ENCODING_RULES","calldata","calldata_1","setSelector","block","generateCalldataBlock","setRoot","encodedCalldata","toString","_","startsWith","Error","hasSelector","rawCalldata","raw_calldata_1","DEFAULT_DECODING_RULES","getSizeInBytes","generateValue","getDefaultValue","returndata","decode","valuesAsArray","isObject","values","isDetailed","isEmpty","name","getSignatureType","getDataItem","lastIndexOfScopeDelimiter","lastIndexOf","isScopedName","shortName","substr","detailedSignature","exports"],"sources":["../../../../src/abi_encoder/abstract_data_types/data_type.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}