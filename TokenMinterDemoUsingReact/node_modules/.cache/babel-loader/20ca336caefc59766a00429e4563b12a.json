{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ethUtil = require(\"ethereumjs-util\");\n\nvar _ = require(\"lodash\");\n\nvar set_1 = require(\"../abstract_data_types/types/set\");\n\nvar constants_1 = require(\"../utils/constants\");\n\nvar tuple_1 = require(\"./tuple\");\n\nvar MethodDataType =\n/** @class */\nfunction (_super) {\n  __extends(MethodDataType, _super);\n\n  function MethodDataType(abi, dataTypeFactory) {\n    var _this = this;\n\n    var methodDataItem = {\n      type: 'method',\n      name: abi.name,\n      components: abi.inputs\n    };\n    _this = _super.call(this, methodDataItem, dataTypeFactory) || this;\n    _this._methodSignature = _this._computeSignature();\n    _this._methodSelector = _this._computeSelector();\n    var returnDataItem = {\n      type: 'tuple',\n      name: abi.name,\n      components: abi.outputs\n    };\n    _this._returnDataType = new tuple_1.TupleDataType(returnDataItem, _this.getFactory());\n    return _this;\n  }\n\n  MethodDataType.prototype.encode = function (value, rules) {\n    var calldata = _super.prototype.encode.call(this, value, rules, this._methodSelector);\n\n    return calldata;\n  };\n\n  MethodDataType.prototype.decode = function (calldata, rules) {\n    var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n\n    return value;\n  };\n\n  MethodDataType.prototype.strictDecode = function (calldata, rules) {\n    var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n\n    var valueAsArray = _.isObject(value) ? _.values(value) : [value];\n\n    switch (valueAsArray.length) {\n      case 0:\n        return undefined;\n\n      case 1:\n        return valueAsArray[0];\n\n      default:\n        return valueAsArray;\n    }\n  };\n\n  MethodDataType.prototype.encodeReturnValues = function (value, rules) {\n    var returnData = this._returnDataType.encode(value, rules);\n\n    return returnData;\n  };\n\n  MethodDataType.prototype.decodeReturnValues = function (returndata, rules) {\n    var returnValues = this._returnDataType.decode(returndata, rules);\n\n    return returnValues;\n  };\n\n  MethodDataType.prototype.strictDecodeReturnValue = function (returndata, rules) {\n    var returnValues = this._returnDataType.decode(returndata, rules);\n\n    var returnValuesAsArray = _.isObject(returnValues) ? _.values(returnValues) : [returnValues];\n\n    switch (returnValuesAsArray.length) {\n      case 0:\n        return undefined;\n\n      case 1:\n        return returnValuesAsArray[0];\n\n      default:\n        return returnValuesAsArray;\n    }\n  };\n\n  MethodDataType.prototype.getSignatureType = function () {\n    return this._methodSignature;\n  };\n\n  MethodDataType.prototype.getSelector = function () {\n    return this._methodSelector;\n  };\n\n  MethodDataType.prototype.getReturnValueDataItem = function () {\n    var returnValueDataItem = this._returnDataType.getDataItem();\n\n    return returnValueDataItem;\n  };\n\n  MethodDataType.prototype._computeSignature = function () {\n    var memberSignature = this._computeSignatureOfMembers();\n\n    var methodSignature = \"\" + this.getDataItem().name + memberSignature;\n    return methodSignature;\n  };\n\n  MethodDataType.prototype._computeSelector = function () {\n    var signature = this._computeSignature();\n\n    var selector = ethUtil.bufferToHex(ethUtil.toBuffer(ethUtil.sha3(signature).slice(constants_1.constants.HEX_SELECTOR_BYTE_OFFSET_IN_CALLDATA, constants_1.constants.HEX_SELECTOR_LENGTH_IN_BYTES)));\n    return selector;\n  };\n\n  return MethodDataType;\n}(set_1.AbstractSetDataType);\n\nexports.MethodDataType = MethodDataType;","map":{"version":3,"sources":["../../../../src/abi_encoder/evm_data_types/method.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ethUtil = require(\"ethereumjs-util\");\nvar _ = require(\"lodash\");\nvar set_1 = require(\"../abstract_data_types/types/set\");\nvar constants_1 = require(\"../utils/constants\");\nvar tuple_1 = require(\"./tuple\");\nvar MethodDataType = /** @class */ (function (_super) {\n    __extends(MethodDataType, _super);\n    function MethodDataType(abi, dataTypeFactory) {\n        var _this = this;\n        var methodDataItem = { type: 'method', name: abi.name, components: abi.inputs };\n        _this = _super.call(this, methodDataItem, dataTypeFactory) || this;\n        _this._methodSignature = _this._computeSignature();\n        _this._methodSelector = _this._computeSelector();\n        var returnDataItem = { type: 'tuple', name: abi.name, components: abi.outputs };\n        _this._returnDataType = new tuple_1.TupleDataType(returnDataItem, _this.getFactory());\n        return _this;\n    }\n    MethodDataType.prototype.encode = function (value, rules) {\n        var calldata = _super.prototype.encode.call(this, value, rules, this._methodSelector);\n        return calldata;\n    };\n    MethodDataType.prototype.decode = function (calldata, rules) {\n        var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n        return value;\n    };\n    MethodDataType.prototype.strictDecode = function (calldata, rules) {\n        var value = _super.prototype.decode.call(this, calldata, rules, this._methodSelector);\n        var valueAsArray = _.isObject(value) ? _.values(value) : [value];\n        switch (valueAsArray.length) {\n            case 0:\n                return undefined;\n            case 1:\n                return valueAsArray[0];\n            default:\n                return valueAsArray;\n        }\n    };\n    MethodDataType.prototype.encodeReturnValues = function (value, rules) {\n        var returnData = this._returnDataType.encode(value, rules);\n        return returnData;\n    };\n    MethodDataType.prototype.decodeReturnValues = function (returndata, rules) {\n        var returnValues = this._returnDataType.decode(returndata, rules);\n        return returnValues;\n    };\n    MethodDataType.prototype.strictDecodeReturnValue = function (returndata, rules) {\n        var returnValues = this._returnDataType.decode(returndata, rules);\n        var returnValuesAsArray = _.isObject(returnValues) ? _.values(returnValues) : [returnValues];\n        switch (returnValuesAsArray.length) {\n            case 0:\n                return undefined;\n            case 1:\n                return returnValuesAsArray[0];\n            default:\n                return returnValuesAsArray;\n        }\n    };\n    MethodDataType.prototype.getSignatureType = function () {\n        return this._methodSignature;\n    };\n    MethodDataType.prototype.getSelector = function () {\n        return this._methodSelector;\n    };\n    MethodDataType.prototype.getReturnValueDataItem = function () {\n        var returnValueDataItem = this._returnDataType.getDataItem();\n        return returnValueDataItem;\n    };\n    MethodDataType.prototype._computeSignature = function () {\n        var memberSignature = this._computeSignatureOfMembers();\n        var methodSignature = \"\" + this.getDataItem().name + memberSignature;\n        return methodSignature;\n    };\n    MethodDataType.prototype._computeSelector = function () {\n        var signature = this._computeSignature();\n        var selector = ethUtil.bufferToHex(ethUtil.toBuffer(ethUtil\n            .sha3(signature)\n            .slice(constants_1.constants.HEX_SELECTOR_BYTE_OFFSET_IN_CALLDATA, constants_1.constants.HEX_SELECTOR_LENGTH_IN_BYTES)));\n        return selector;\n    };\n    return MethodDataType;\n}(set_1.AbstractSetDataType));\nexports.MethodDataType = MethodDataType;\n//# sourceMappingURL=method.js.map"]},"metadata":{},"sourceType":"script"}